# 实验5-应用高可用i2Availability

## 目标

- 掌握Oracle（单机架构）的高可用保护能力。
- 掌握高可用规则关键配置参数。
- 掌握应用软件启停的脚本编写。
- 掌握应用切换和回切操作的注意点。

## 环境

- 准备工作机系统vm1，建议使用考试中心提供的虚拟机模板（CentOS 7.6 Oracle12c）创建。
- 建议先完成i2Move实验，通过i2Move功能快速建立灾备机所需要的环境（Oracle单机）。
- 登录你的备机，检查Oracle数据是否能够启动？ 监听服务是否正常？【记得修改 /etc/hosts 文件和IP地址】
  或者返回 课程页面的“准备工作”视频自查。
- 工作机vm1和灾备机vm2处于同一网段。
- 工作机和灾备机安装i2node软件。
- 登录控制台，注册工作机和灾备机，授权ha许可。
- 控制台主机vm3安装i2node软件，作为仲裁节点。

## 拓扑

![image.png](https://raw.githubusercontent.com/shuiyuewusong/Image-storage/main/test/image-2024-05-25-16-16-59-715.png)

## 要求

- 创建高可用规则，配置如下： 1）基本设置页面，启用自动切换。 2）考虑到心跳脑裂情况，本实验配置仲裁节点（控制台主机需安装i2node软件）【1分】
- 配置数据同步目录，包含oracle参数文件、密码文件、控制文件、数据文件、日志文件及归档文件所在目录【1分】
- 监控对象页面将Oracle数据库后台进程作为监控对象【1分】 4）资源切换页面，配置虚拟IP（虚拟IP地址请根据自己网段自行选择） 【1分】
- 资源切换页面，启停脚本需要自己编写，并提前验证有效性（参考Oracle启停脚本附录） 【1分】
- 提交高可用规则后，启动正向复制规则，等规则状态处于就绪。【1分】
- 登录源主机数据库，模拟产生增量数据,参考Oracle增量数据。【1分】
- 本地PC持续ping虚拟IP地址，然后模拟源端主机故障（关机），观察IP地址丢包情况并截图【1分】
- 在目标主机登录数据库，模拟产生增量数据，数据落盘保存
- 在源端主机启动系统后，启动反向复制规则，待规则状态处于就绪，尝试手工回切 【1分】
- 源端主机重新接管Oracle服务，检查源主机Oracle数据库数据的正确性 【1分】
  备注：实验完成后，删除高可用规则并回收相关资源。